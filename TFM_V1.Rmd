---
title: "TFM_v1"
author: "María Perea"
date: "9 de julio de 2020"
output: html_document
---

#### Importando fichero "Mortality_rate_Newborn_Child.csv"
****IMPORTANDO fichero con el indicador: Selección y cambio de nombre en columnas, creando tabla de Wide a Longer.
```{r}
Rate_Child_all<-read.csv("Mortality_rate_Newborn_Child.csv",sep=",",header = TRUE,stringsAsFactors = FALSE,skip = 2)
Rate_Child<-Rate_Child_all[ ,c(1,31:59)]
colnames(Rate_Child)<-c("Who_Region","2018","2017","2016","2015","2014","2013","2012","2011","2010","2009","2008","2007","2006","2005","2004","2003","2002","2001","2000","1999","1998","1997","1996","1995","1994","1993","1992","1991","1990")

Rate_Child <- Rate_Child %>%
  pivot_longer(cols=`2018`:`1990`,
               names_to="year",
               values_to = "Rate_Mort_Child",
               names_ptypes = list(year=integer()))
glimpse(Rate_Child)
unique(Rate_Child$Who_Region)
unique(Rate_Child$year)
```

#### Análisis indicador Rate_Mort_Child
****Pivotando tabla de Longer a Wide (Regiones en columnas)

```{r}
Rate_Child_wide <- Rate_Child %>%
  pivot_wider(names_from=Who_Region, 
              values_from=Rate_Mort_Child)

stat_wide<-stat.desc(Rate_Child_wide,norm = TRUE)
stat_wide<-round(stat_wide,2)
stat_wide

```

###### Gráficos

```{r}
ggplot(data=Rate_Child,aes(x=Who_Region,y=Rate_Mort_Child))+
 geom_boxplot(aes(fill=Who_Region)) +
  ggtitle("Mortality Rate Child(Under Five years) per 1000 live births")+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(axis.text.x=element_text(angle=60, hjust=1))



ggplot(data=Rate_Child,aes(x=year,y=Rate_Mort_Child))+
  geom_point(aes(col=Who_Region))+
  ggtitle("Mortality Rate Child(Under Five years) per 1000 live births")
```


#### Importando fichero "International_Health_Regulations.csv""
**** Contiene 13 indicadores de la Regulación Internacional de Salud(Encuestas)
**** Se importa el fichero seleccionando las columnas de cada indicador
**** Pivotando cada tabla de Wide a Longer


```{r}

Int_Health_Regulat<-read.csv("International_Health_Regulations.csv",sep=",",header = TRUE,stringsAsFactors = FALSE,skip = 1)

#### Legislation
Int_Health_Regulat_Legislation<-Int_Health_Regulat[ ,c(1:9)]
colnames(Int_Health_Regulat_Legislation)<-c("Who_Region","2017","2016","2015","2014","2013","2012","2011","2010")
Int_Health_Regulat_Legislation <- Int_Health_Regulat_Legislation %>%
  pivot_longer(cols=`2017`:`2010`,
               names_to="year",
               values_to = "Legislation",
               names_ptypes = list(year=integer()))

#### Coordination
Int_Health_Regulat_Coordination<-Int_Health_Regulat[ ,c(1,10:17)]
colnames(Int_Health_Regulat_Coordination)<-c("Who_Region","2017","2016","2015","2014","2013","2012","2011","2010")
Int_Health_Regulat_Coordination<- Int_Health_Regulat_Coordination %>%
  pivot_longer(cols=`2017`:`2010`,
               names_to="year",
               values_to = "Coordination",
               names_ptypes = list(year=integer()))

#### Surveillance
Int_Health_Regulat_Surveillance<-Int_Health_Regulat[ ,c(1,18:25)]                                          
colnames(Int_Health_Regulat_Surveillance)<-c("Who_Region","2017","2016","2015","2014","2013","2012","2011","2010")
Int_Health_Regulat_Surveillance<- Int_Health_Regulat_Surveillance %>%
  pivot_longer(cols=`2017`:`2010`,
               names_to="year",
               values_to = "Surveillance",
               names_ptypes = list(year=integer()))
#### Response
Int_Health_Regulat_Response<-Int_Health_Regulat[ ,c(1,26:33)]
colnames(Int_Health_Regulat_Response)<-c("Who_Region","2017","2016","2015","2014","2013","2012","2011","2010")
Int_Health_Regulat_Response<- Int_Health_Regulat_Response %>%
  pivot_longer(cols=`2017`:`2010`,
               names_to="year",
               values_to = "Response",
               names_ptypes = list(year=integer()))
#### Preparedness
Int_Health_Regulat_Preparedness<-Int_Health_Regulat[ ,c(1,34:41)]
colnames(Int_Health_Regulat_Preparedness)<-c("Who_Region","2017","2016","2015","2014","2013","2012","2011","2010")
Int_Health_Regulat_Preparedness<- Int_Health_Regulat_Preparedness %>%
  pivot_longer(cols=`2017`:`2010`,
               names_to="year",
               values_to = "Preparedness",
               names_ptypes = list(year=integer()))
 
#### Risk_communication
Int_Health_Regulat_Risk_communication<-Int_Health_Regulat[ ,c(1,42:49)]
colnames(Int_Health_Regulat_Risk_communication)<-c("Who_Region","2017","2016","2015","2014","2013","2012","2011","2010")
Int_Health_Regulat_Risk_communication<- Int_Health_Regulat_Risk_communication %>%
  pivot_longer(cols=`2017`:`2010`,
               names_to="year",
               values_to = "Risk_communication",
               names_ptypes = list(year=integer()))

#### Human_resources
Int_Health_Regulat_Human_resources<-Int_Health_Regulat[ ,c(1,50:57)]
colnames(Int_Health_Regulat_Human_resources)<-c("Who_Region","2017","2016","2015","2014","2013","2012","2011","2010")
Int_Health_Regulat_Human_resources<- Int_Health_Regulat_Human_resources %>%
  pivot_longer(cols=`2017`:`2010`,
               names_to="year",
               values_to = "Human_resources",
               names_ptypes = list(year=integer()))

#### Laboratory
Int_Health_Regulat_Laboratory<-Int_Health_Regulat[ ,c(1,58:65)]
colnames(Int_Health_Regulat_Laboratory)<-c("Who_Region","2017","2016","2015","2014","2013","2012","2011","2010")
Int_Health_Regulat_Laboratory<- Int_Health_Regulat_Laboratory %>%
  pivot_longer(cols=`2017`:`2010`,
               names_to="year",
               values_to = "Laboratory",
               names_ptypes = list(year=integer()))
#### Points_entry
Int_Health_Regulat_Points_entry<-Int_Health_Regulat[ ,c(1,66:73)]
colnames(Int_Health_Regulat_Points_entry)<-c("Who_Region","2017","2016","2015","2014","2013","2012","2011","2010")
Int_Health_Regulat_Points_entry<- Int_Health_Regulat_Points_entry %>%
  pivot_longer(cols=`2017`:`2010`,
               names_to="year",
               values_to = "Points_entry",
               names_ptypes = list(year=integer()))
#### Zoonosis
Int_Health_Regulat_Zoonosis<-Int_Health_Regulat[ ,c(1,74:81)]
colnames(Int_Health_Regulat_Zoonosis)<-c("Who_Region","2017","2016","2015","2014","2013","2012","2011","2010")
Int_Health_Regulat_Zoonosis<- Int_Health_Regulat_Zoonosis %>%
  pivot_longer(cols=`2017`:`2010`,
               names_to="year",
               values_to = "Zoonosis",
               names_ptypes = list(year=integer()))
#### Food_safety
Int_Health_Regulat_Food_safety<-Int_Health_Regulat[ ,c(1,82:89)]
colnames(Int_Health_Regulat_Food_safety)<-c("Who_Region","2017","2016","2015","2014","2013","2012","2011","2010")
Int_Health_Regulat_Food_safety<- Int_Health_Regulat_Food_safety %>%
  pivot_longer(cols=`2017`:`2010`,
               names_to="year",
               values_to = "Food_safety",
               names_ptypes = list(year=integer()))
#### Chemical
Int_Health_Regulat_Chemical<-Int_Health_Regulat[ ,c(1,90:97)]
colnames(Int_Health_Regulat_Chemical)<-c("Who_Region","2017","2016","2015","2014","2013","2012","2011","2010")
Int_Health_Regulat_Chemical<- Int_Health_Regulat_Chemical %>%
  pivot_longer(cols=`2017`:`2010`,
               names_to="year",
               values_to = "Chemical",
               names_ptypes = list(year=integer()))

#### Radionuclear
Int_Health_Regulat_Radionuclear<-Int_Health_Regulat[ ,c(1,98:105)]
colnames(Int_Health_Regulat_Radionuclear)<-c("Who_Region","2017","2016","2015","2014","2013","2012","2011","2010")
Int_Health_Regulat_Radionuclear<- Int_Health_Regulat_Radionuclear %>%
  pivot_longer(cols=`2017`:`2010`,
               names_to="year",
               values_to = "Radionuclear",
               names_ptypes = list(year=integer()))
```

#### Fusionando con merge los 13 indicadores. Análisis de la fusión con glimpse, unique and stat.desc

```{r}
m1<-Reduce(function(...) merge(..., all=T), list(Int_Health_Regulat_Legislation,
                                                 Int_Health_Regulat_Coordination,
                                                 Int_Health_Regulat_Surveillance,
                                                 Int_Health_Regulat_Response,
                                                 Int_Health_Regulat_Preparedness,
                                                 Int_Health_Regulat_Risk_communication,
                                                 Int_Health_Regulat_Human_resources,
                                                 Int_Health_Regulat_Laboratory,
                                                 Int_Health_Regulat_Points_entry,
                                                 Int_Health_Regulat_Zoonosis,
                                                 Int_Health_Regulat_Food_safety,
                                                 Int_Health_Regulat_Chemical,
                                                 Int_Health_Regulat_Radionuclear))

glimpse(m1)
unique(m1$Who_Region)
unique(m1$year)
m1_num<-select_if(m1,is.numeric)
stat_m1<-stat.desc(m1_num)
stat_m1<-round(stat_m1,0)
stat_m1


```

#### Fusionando indicador principal con indicadores International_Health_Regulation 
**** Se decide excluir "Global" del indicador principal, porque en el resto de indicadores sólo está para dos años
**** Por tanto, nos quedaríamos con 7 años de evolutivo (2010-2017)
```{r}
Rate_Child_new<-Rate_Child %>% filter(Who_Region != "Global")
m2<-Reduce(function(...) merge (..., all=F), list(Rate_Child_new,m1))
glimpse(m2)
unique(m2$Who_Region)
unique(m2$year)
```

#### Importando 12 ficheros con los Ratios de Mortalidad por causa (variable: <5 años)
**** Sólo nos interesa la variable (0-4 years)
**** Se homogeiniza valores de "Who_Region"

```{r}
#### Asphyxia
Mort_Asphyxia_rate<-read.csv("MORT_Asphyxia_rate.csv",sep=",",header = TRUE,stringsAsFactors = FALSE,skip = 2)
Mort_Asphyxia_rate<-Mort_Asphyxia_rate[ ,c(1:2,5)]
colnames(Mort_Asphyxia_rate)<-c("Who_Region","year","Mort_Asphyxia_rate")

Mort_Asphyxia_rate$Who_Region[Mort_Asphyxia_rate$Who_Region == "Africa Region"]<-"Africa" 
Mort_Asphyxia_rate$Who_Region[Mort_Asphyxia_rate$Who_Region == "Region of the Americas"]<-"Americas"
Mort_Asphyxia_rate$Who_Region[Mort_Asphyxia_rate$Who_Region == "Eastern Mediterranean Region"]<-"Eastern Mediterranean"
Mort_Asphyxia_rate$Who_Region[Mort_Asphyxia_rate$Who_Region == "European Region"]<-"Europe"
Mort_Asphyxia_rate$Who_Region[Mort_Asphyxia_rate$Who_Region == "South-East Asia Region"]<-"South-East Asia"
Mort_Asphyxia_rate$Who_Region[Mort_Asphyxia_rate$Who_Region == "Western Pacific Region"]<-"Western Pacific"

glimpse(Mort_Asphyxia_rate)
unique(Mort_Asphyxia_rate$Who_Region)

####  Congenital_anom
Mort_Congenital_rate<-read.csv("MORT_Congenital_rate.csv",sep=",",header = TRUE,stringsAsFactors = FALSE,skip = 2)
Mort_Congenital_rate<-Mort_Congenital_rate[ ,c(1:2,5)]
colnames(Mort_Congenital_rate)<-c("Who_Region","year","Mort_Congenital_rate")

Mort_Congenital_rate$Who_Region[Mort_Congenital_rate$Who_Region == "Africa Region"]<-"Africa" 
Mort_Congenital_rate$Who_Region[Mort_Congenital_rate$Who_Region == "Region of the Americas"]<-"Americas"
Mort_Congenital_rate$Who_Region[Mort_Congenital_rate$Who_Region == "Eastern Mediterranean Region"]<-"Eastern Mediterranean"
Mort_Congenital_rate$Who_Region[Mort_Congenital_rate$Who_Region == "European Region"]<-"Europe"
Mort_Congenital_rate$Who_Region[Mort_Congenital_rate$Who_Region == "South-East Asia Region"]<-"South-East Asia"
Mort_Congenital_rate$Who_Region[Mort_Congenital_rate$Who_Region == "Western Pacific Region"]<-"Western Pacific"

glimpse(Mort_Congenital_rate)
unique(Mort_Congenital_rate$Who_Region)

####  Diarrhoeal_diseases

Mort_Diarrhoeal_diseases_rate<-read.csv("MORT_Diarre_rate.csv",sep=",",header = TRUE,stringsAsFactors = FALSE,skip = 2)
Mort_Diarrhoeal_diseases_rate<-Mort_Diarrhoeal_diseases_rate[ ,c(1:2,5)]
colnames(Mort_Diarrhoeal_diseases_rate)<-c("Who_Region","year","Mort_Diarrhoeal_rate")

Mort_Diarrhoeal_diseases_rate$Who_Region[Mort_Diarrhoeal_diseases_rate$Who_Region == "Africa Region"]<-"Africa" 
Mort_Diarrhoeal_diseases_rate$Who_Region[Mort_Diarrhoeal_diseases_rate$Who_Region == "Region of the Americas"]<-"Americas"
Mort_Diarrhoeal_diseases_rate$Who_Region[Mort_Diarrhoeal_diseases_rate$Who_Region == "Eastern Mediterranean Region"]<-"Eastern Mediterranean"
Mort_Diarrhoeal_diseases_rate$Who_Region[Mort_Diarrhoeal_diseases_rate$Who_Region == "European Region"]<-"Europe"
Mort_Diarrhoeal_diseases_rate$Who_Region[Mort_Diarrhoeal_diseases_rate$Who_Region == "South-East Asia Region"]<-"South-East Asia"
Mort_Diarrhoeal_diseases_rate$Who_Region[Mort_Diarrhoeal_diseases_rate$Who_Region == "Western Pacific Region"]<-"Western Pacific"

glimpse(Mort_Diarrhoeal_diseases_rate)
unique(Mort_Diarrhoeal_diseases_rate$Who_Region)


####  MORT_HIVAIDS_rate

Mort_HIVAIDS_rate<-read.csv("MORT_HIVAIDS_rate.csv",sep=",",header = TRUE,stringsAsFactors = FALSE,skip = 2)
Mort_HIVAIDS_rate<-Mort_HIVAIDS_rate[ ,c(1:2,5)]
colnames(Mort_HIVAIDS_rate)<-c("Who_Region","year","Mort_HIVAIDS_dis_rate")

Mort_HIVAIDS_rate$Who_Region[Mort_HIVAIDS_rate$Who_Region == "Africa Region"]<-"Africa" 
Mort_HIVAIDS_rate$Who_Region[Mort_HIVAIDS_rate$Who_Region == "Region of the Americas"]<-"Americas"
Mort_HIVAIDS_rate$Who_Region[Mort_HIVAIDS_rate$Who_Region == "Eastern Mediterranean Region"]<-"Eastern Mediterranean"
Mort_HIVAIDS_rate$Who_Region[Mort_HIVAIDS_rate$Who_Region == "European Region"]<-"Europe"
Mort_HIVAIDS_rate$Who_Region[Mort_HIVAIDS_rate$Who_Region == "South-East Asia Region"]<-"South-East Asia"
Mort_HIVAIDS_rate$Who_Region[Mort_HIVAIDS_rate$Who_Region == "Western Pacific Region"]<-"Western Pacific"

glimpse(Mort_HIVAIDS_rate)
unique(Mort_HIVAIDS_rate$Who_Region)
```





## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
